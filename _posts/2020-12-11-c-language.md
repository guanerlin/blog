---

layout: post
title: "C Language Notion"
date: 2020-12-11 22:51:10 +0800
tags: language c
categories: programming
---

今天发现C语言忘光了。其实就是压根当年学的时候，没有太在意，后来工作中也没有认真思考和总结回顾过。
说来惭愧，写了这么久iOS程序，一直不能深入了解很多东西，原来都是因为我C语言这层就是个丈二的和尚。
趁着周末，赶紧补补吧。这个周末补补C基础，把[这个网站](https://www.runoob.com/cprogramming/c-variables.html)的都走一遍基础理论知识。

### OKR

#### Objective
	复习C语言基础
	结合已有iOS项目，对应目前项目中已使用的C相关代码，扫盲阶段
	用C语言写一遍排序算法

#### Key Result
	用C语言写排序算法
	通过C语言，丰富对内存，编译，程序底层一些的基础知识
	读完一本C语言的书


#### Duration
	希望是本月个人碎片时间完成


<br>

----------------------------------------------------------------

<br>



### Note Part 1（2020-12-11）

1. **关于编译器**：
	
- `Clang`是C语言家族的编译器
	
2. **基础知识**
	- C 语言程序文件的后缀为` .c`
	- 在`.m`中写C语言和`.c`(c语言文件格式，.h objc和c是一样的作用)中是一样等效的
	编译过程示意图

	![When we both move th rocks](/assets/compile_process.png)

3. **基本变量类型**
	- `int` `char` `float` `double` `void`(void代表没有任何值)
	- extern关键字：在方法外定义的变量，是全局变量，在其他文件想引用，需要使用extern关键字声明
	- 全局变量内存被分配在全区存储区中，局部本地变量分配在栈stack上，只有函数在被调用时才被临时分配存储单元

		```
		语言经过编译之后将内存分为以下几个区域：
		1）栈（stack）：由编译器进行管理，自动分配和释放，存放函数调用过程中的各种参数、局部变量、返回值以及函数返回地址。操作方式类似数据结构中的栈。
		2）堆（heap）：用于程序动态申请分配和释放空间。C语言中的malloc和free，C++中的new和delete均是在堆中进行的。正常情况下，程序员申请的空间在使用结束后应该释放，若程序员没有释放空间，则程序结束时系统自动回收。注意：这里的“堆”并不是数据结构中的“堆”。
		3）全局（静态）存储区：分为DATA段和BSS段。DATA段（全局初始化区）存放初始化的全局变量和静态变量；BSS段（全局未初始化区）存放未初始化的全局变量和静态变量。程序运行结束时自动释放。其中BBS段在程序执行之前会被系统自动清0，所以未初始化的全局变量和静态变量在程序执行之前已经为0。
		4）文字常量区：存放常量字符串。程序结束后由系统释放。
		5）程序代码区：存放程序的二进制代码。
		```

	- `int`是4个字节，`char`是1个字节，`float`是8个字节，这个所使用的程序架构有关，比如32位还是64位的cpu archetecture
	- 在`.h`中写c方法声明，在`.c`中引用后即可使用，`include "xx.h"`
	- c99之前c语言没有布尔值
	- **sizeof**使用

		```
		#include <limits.h>
		//sizeof方法可以打印变量所占用字节数

		printf("sizeof char in X86_64 = %lu\n",sizeof(char));
		```

	- 变量地址分配，我的Macbook pro Intel `X86_64`先定义的地址值会更大，不赋值的变量默认值是0


		```
	int i,j,b;
	printf("i addr :%p, j addr:%p \n", &i, &j);
	/// output:
		i addr :0x7ffee715fbb4, j addr:0x7ffee715fbb0
		```
4. **常量**
	- 常量,不可修改
	- 字符串字面值或常量是括在双引号 "" 中的
	- 两种方式
		`define`预处理器 和 `const`关键字
		1. define identifier value
		2. const type variable = value，`const`定义的是变量，只不过这是个不可修改的变量
		3. 常量大写

5. **存储类**

  **auto, register, static, extern四个存储类型**
  1. auto：是局部变量方法内部默认的存储类型
  
  2. register：是寄存器存储类型，指让变量不要存到内存(RAM)中，可能存到寄存器里(受硬件限制)，用的地方比较少，一般是用于需要快速访问的变量比如计数器。不能它修饰的变量使用按位与&因为变量没有内存地址

  3. static:
  - static 存储类指示编译器在程序的生命周期内保持局部变量的存在。在方法内声明的static变量，作用域是方法内
  - static 修饰符也可以应用于全局变量。当 static 修饰全局变量时，会使变量的作用域限制在声明它的文件内。
  - static 修饰的全局变量和方法后，可以在该文件内被调用
  - 思考下`objc`中单例对象的实现

  4. extern:

  - extern 存储类用于提供一个全局变量的引用
  - 当您有多个文件且定义了一个可以在其他文件中使用的全局变量或函数时，可以在其他文件中使用 extern 来得到已定义的变量或函数的引用。可以这么理解，extern 是用来在另一个文件中声明一个全局变量或函数。

  
```
  + (instancetype)sharedManager {
      static AFNetworkReachabilityManager *_sharedManager = nil;
      static dispatch_once_t onceToken;
      dispatch_once(&onceToken, ^{
          _sharedManager = [self manager];
      });
      return _sharedManager;
  }
```

<br>

----------------------------------------------------------------

<br>

### Note Part 2（2020-12-12)

1. 函数
	- 方法声明，可以省去形式参数，只使用参数类型即可，方法名和参数列表一起构成了方法签名
	- main方法可以有0个参数或者两个参数(其实第三个参数可以是`char**`，因为我尝试了一下)，两个参数的样式如下形参argc的意思是参数个数，默认可执行文件名字是第一个参数，后面跟的参数依次放入数组argv

	ps:形参名称可任意，这里只要参数类型是对的即可
	- 本质上说，C 里面所有的函数参数传递，都是值传递

2. 格式占位符(%)是在C/C++语言中格式输入函数，如 `scanf`、`printf`等函数中使用。其意义就是起到格式占位的意思，表示在该位置有输入或者输出。

 %d, %i 代表整数

 %f 浮点

 %s 字符串

 %c char

 %p 指针

 %fL 长log

 %e 科学计数

 %g 小数或科学计数。

 %a,%A 读入一个浮点值(仅C99有效)。

 %c 读入一个字符。

 %d 读入十进制整数。

 %i 读入十进制，八进制，十六进制整数。

 %o 读入八进制整数。

 %x,%X 读入十六进制整数。

 %s 读入一个字符串，遇空格、制表符或换行符结束。

 %f,%F,%e,%E,%g,%G 用来输入实数，可以用小数形式或指数形式输入。

 %p 读入一个指针。

 %u 读入一个无符号十进制整数。

 %n 至此已读入值的等价字符数。

 %[] 扫描字符集合。

 %% 读 % 符号

****
<br>

### Note Part 3(2020-12-13)

1. **全局变量**
	- 全局变量是定义在函数外部，通常是在程序的顶部。全局变量在整个程序生命周期内都是有效的，在任意的函数内部能访问全局变量。

	- 全局变量可以被任何函数访问。也就是说，全局变量在声明后整个程序中都是可用的。
	
	- 当局部变量被定义时，系统不会对其初始化，您必须自行对其初始化。定义全局变量时，系统会自动对其初始化

2. **指针**

	- 指针是一个变量
	- `*`是证明一个变量是指针类型的符号，`&`是取变量地址的符号
	- 指针这个变量存储的值，是某个类型的变量在内存中的地址
	- 指针的指针是一个变量，他的值是一个指针变量的内存地址
	- 函数指针，是指向函数的指针变量，下面的例子是不是很像block的声明


		`typedef int (*fun_ptr)(int,int);`

3. **数组**
	- c语言支持数组***数据结构***，数组中存放的是*相同数据类型*的变量，~~他们在内存中是连续存放的~~


4. **字符串**
	- c语言字符串就是一个以'\0'`null`为结尾的字符数组
	- ''里面只能放一个字符; "" 里面表示是字符串系统自动会在串末尾补一个0。

		```
		<!-- char greeting[6] = {'H', 'e', 'l', 'l', 'o', '\0'}; -->

		char greeting[] = "Hello";
				
		printf("Greeting message: %s\n", greeting );
		```

5. **结构体**
	- C 数组允许定义可存储相同类型数据项的变量，结构是C语言编程中另一种用户自定义的可用的数据类型，它允许您存储不同类型的数据项。
	- 结构体的成员可以包含其他结构体，也可以包含指向自己结构体类型的指针，这可以形成更复杂的结构，比如链表和树等
	- struct定义了一个包含多个成员呢数据变量的新数据类型，就像数据库里的一条记录
	- variable-list 结构变量，定义在结构的末尾，最后一个分号之前，您可以指定一个或多个结构变量。下面是声明结构的方式：
	- tag 是结构体标签

		```
	struct tag { 
	    member-list
	    member-list 
	    member-list  
	    ...
	} variable-list ;
	//或使用typedef定义结构体
	typedef struct {
		char name[50];
		int price;
	} Book;
		```



*未完待续...*